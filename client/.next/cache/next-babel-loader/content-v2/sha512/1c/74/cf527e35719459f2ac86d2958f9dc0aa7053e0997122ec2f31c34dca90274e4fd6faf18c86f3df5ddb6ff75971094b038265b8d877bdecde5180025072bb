{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/Users/zknock/Develop/localhost_web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/zknock/Develop/localhost_web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { DatePicker, MuiPickersUtilsProvider } from '@material-ui/pickers';\nimport DateFnsUtils from '@date-io/date-fns';\nimport React, { useContext, useState } from 'react';\nimport styled from 'styled-components';\nimport Button from '../reuse/Button';\nimport UserPhoto from '../user/UserPhoto';\nimport LanguageTag from '../reuse/LanguageTag';\nimport Rating from '../reuse/Rating';\nimport HostReviewItem from './HostReviewItem';\nimport axios from 'axios';\nimport { UserStateContext } from '../../context/user';\nimport SERVER from '../../utils/url';\nimport Router from 'next/router';\nimport TravelStyleTag from '../reuse/TravelStyleTag';\nimport FollowButton from '../user/FollowButton';\nimport { CircularProgress } from '@material-ui/core';\nimport { useAsync } from 'react-async';\nvar HostDetailContainer = styled.section.withConfig({\n  displayName: \"HostDetail__HostDetailContainer\",\n  componentId: \"sc-1f76q5z-0\"\n})([\"width:100%;& > *{padding:1rem 0;border-bottom:1px solid #aaa;&:last-child{border-bottom:none;}}& .profile{display:flex;align-items:flex-end;justify-content:flex-start;flex-wrap:wrap;& .name{margin:0;flex:1;& h2{margin:0;margin-right:1rem;}}& > .apply{flex:1;display:flex;min-width:300px;max-width:360px;justify-content:flex-end;margin-top:1rem;& > div{flex:1;}& > *{margin:0 1em;}}}& .basicInfo,& .additionalInfo{& > table{width:100%;& tr.introduction{white-space:pre;vertical-align:baseline;}& td{padding:0.5rem;&:first-child{width:20%;}}}}& .reviews{& > div:first-child{display:flex;align-items:center;margin:1em 0;& > h3{margin:0 0.5em 0 0;}}}& .flex{display:flex;align-items:center;}\"]);\n\nvar isFollowed = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n    var userId, followerId, res;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            userId = _ref.userId, followerId = _ref.followerId;\n            _context.next = 3;\n            return axios.post(\"\".concat(SERVER, \"/api/user/follow_check\"), {\n              userId: userId,\n              followerId: followerId\n            });\n\n          case 3:\n            res = _context.sent;\n            return _context.abrupt(\"return\", res.data);\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function isFollowed(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar Loading = function Loading() {\n  return /*#__PURE__*/_jsx(\"div\", {\n    style: {\n      textAlign: 'center',\n      height: '85vh',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    children: /*#__PURE__*/_jsx(CircularProgress, {})\n  });\n};\n\nvar HostDetail = function HostDetail(props) {\n  var host = props.host,\n      reviews = props.reviews,\n      initialFollowed = props.initialFollowed;\n\n  var _useState = useState(new Date()),\n      date = _useState[0],\n      setDate = _useState[1];\n\n  var onChangeDate = function onChangeDate(newDate) {\n    if (newDate >= new Date()) setDate(newDate);\n  };\n\n  var currentUser = useContext(UserStateContext);\n\n  var onApply = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return axios.post(\"\".concat(SERVER, \"/api/host/application\"), {\n                id: currentUser.id,\n                hostUserId: host.id,\n                date: date\n              });\n\n            case 2:\n              res = _context2.sent;\n              res.data.success ? Router.push('/hosts') : alert('신청에 실패했습니다.');\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function onApply() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var _useState2 = useState(false),\n      on = _useState2[0],\n      setOn = _useState2[1];\n\n  var _useAsync = useAsync({\n    promiseFn: isFollowed,\n    userId: host.id,\n    followerId: currentUser.id\n  }),\n      followed = _useAsync.data,\n      error = _useAsync.error,\n      isLoading = _useAsync.isLoading;\n\n  if (isLoading) return /*#__PURE__*/_jsx(Loading, {});\n  if (error) return /*#__PURE__*/_jsx(\"div\", {\n    style: {\n      fontSize: '0.5em',\n      color: '#e74c3c'\n    },\n    children: \"\\uD314\\uB85C\\uC6B0\\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC624\\uC9C0\\uBABB\\uD588\\uC2B5\\uB2C8\\uB2E4.\"\n  });\n  if (!followed) return null;\n  return /*#__PURE__*/_jsxs(HostDetailContainer, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"profile\",\n      children: [/*#__PURE__*/_jsx(UserPhoto, {\n        src: host.photo,\n        width: 8,\n        margin: \"0 1rem 0 0\"\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"name\",\n        children: [/*#__PURE__*/_jsx(Rating, {\n          rating: host.rating || 0,\n          isFilled: true\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex\",\n          children: [/*#__PURE__*/_jsx(\"h2\", {\n            children: host.nickname\n          }), /*#__PURE__*/_jsx(FollowButton, {\n            userId: host.id,\n            initialFollowed: followed !== null && followed !== void 0 ? followed : false\n          })]\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"apply\",\n        children: [/*#__PURE__*/_jsx(MuiPickersUtilsProvider, {\n          utils: DateFnsUtils,\n          children: /*#__PURE__*/_jsx(DatePicker, {\n            format: \"yyyy/MM/dd\",\n            margin: \"dense\",\n            label: \"\\uC5EC\\uD589 \\uB0A0\\uC9DC\",\n            value: date,\n            onChange: onChangeDate,\n            autoOk: true,\n            disablePast: true,\n            disableToolbar: true\n          })\n        }), /*#__PURE__*/_jsx(Button, {\n          padding: \"0.5em 1.5rem\",\n          onClick: onApply,\n          style: {\n            fontSize: '1em',\n            fontWeight: 600\n          },\n          children: \"\\uC2E0\\uCCAD\"\n        })]\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"basicInfo\",\n      children: [/*#__PURE__*/_jsx(\"h3\", {\n        children: \"\\uAE30\\uBCF8\\uC815\\uBCF4\"\n      }), /*#__PURE__*/_jsx(\"table\", {\n        children: /*#__PURE__*/_jsxs(\"tbody\", {\n          children: [/*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: \"\\uC131\\uBCC4\"\n            }), /*#__PURE__*/_jsx(\"td\", {\n              children: host.sex === 'male' ? '남' : '여'\n            })]\n          }), /*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: \"\\uD65C\\uB3D9\\uC9C0\\uC5ED\"\n            }), /*#__PURE__*/_jsx(\"td\", {\n              children: host.place.formatted_address\n            })]\n          }), /*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: \"\\uC0AC\\uC6A9\\uC5B8\\uC5B4\"\n            }), /*#__PURE__*/_jsx(\"td\", {\n              children: host.languages.map(function (lang) {\n                return lang ? /*#__PURE__*/_jsx(LanguageTag, {\n                  language: lang\n                }, lang) : '';\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(\"tr\", {\n            className: \"introduction\",\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: \"\\uC790\\uAE30\\uC18C\\uAC1C\"\n            }), /*#__PURE__*/_jsx(\"td\", {\n              children: host.description\n            })]\n          })]\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"additionalInfo\",\n      children: [/*#__PURE__*/_jsx(\"h3\", {\n        children: \"\\uCD94\\uAC00\\uC815\\uBCF4\"\n      }), /*#__PURE__*/_jsx(\"table\", {\n        children: /*#__PURE__*/_jsxs(\"tbody\", {\n          children: [/*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: \"\\uC5EC\\uD589\\uC2A4\\uD0C0\\uC77C\"\n            }), /*#__PURE__*/_jsx(\"td\", {\n              children: /*#__PURE__*/_jsx(TravelStyleTag, {\n                label: \"\\uBB38\\uD654\\uC7AC\",\n                onClick: function onClick() {\n                  setOn(!on);\n                },\n                checked: on\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: \"\\uB9E4\\uCE6D\\uD69F\\uC218\"\n            }), /*#__PURE__*/_jsx(\"td\", {\n              children: 0\n            })]\n          }), /*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              children: \"\\uC2B9\\uB099\\uB960\"\n            }), /*#__PURE__*/_jsxs(\"td\", {\n              children: [0, \"%\"]\n            })]\n          })]\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"reviews\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"reviews_title\",\n        children: [/*#__PURE__*/_jsx(\"h3\", {\n          children: \"\\uD6C4\\uAE30\"\n        }), /*#__PURE__*/_jsx(Rating, {\n          rating: host.rating || 0,\n          isFilled: true\n        })]\n      }), reviews.length ? reviews.map(function (review) {\n        return /*#__PURE__*/_jsx(HostReviewItem, {\n          review: review\n        }, review.id);\n      }) : /*#__PURE__*/_jsx(NoReview, {})]\n    })]\n  });\n};\n\nvar NoReview = function NoReview() {\n  return /*#__PURE__*/_jsx(\"div\", {\n    style: {\n      padding: '0.5rem'\n    },\n    children: \"\\uD6C4\\uAE30\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"\n  });\n};\n\nexport default HostDetail;","map":null,"metadata":{},"sourceType":"module"}